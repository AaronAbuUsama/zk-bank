# zk-bank - Epic Breakdown

**Date:** 2025-11-27
**Project Level:** Quick-Flow (Enterprise slice)

---

## Epic 1: Foundation Infrastructure

**Slug:** foundation-infra

### Goal

Establish the architectural foundation that enables all subsequent features by simplifying the CLI to interactive-first, implementing centralized state management, setting up real-time backend infrastructure, and creating the core UI shell with theming support.

### Scope

**In Scope:**
- Simplify CLI to Ink-first with essential commands (config, chain, help, version)
- Install and configure Jotai for atomic state management
- Install and configure Convex backend infrastructure
- Implement theme system with 5 selectable themes
- Create AppShell layout (Banner, Footer, TabNav)
- Create placeholder pages (Dashboard, Trollbox, Chain)
- Implement keyboard navigation
- Local config persistence

**Out of Scope:**
- Page content implementation
- Convex functions beyond schema
- Groq/LLM integration
- Cast CDP operations
- Onboarding flow
- Trade-from-chat functionality

### Success Criteria

1. `zk-bank` launches interactive Ink app by default
2. `zk-bank --help`, `zk-bank config`, `zk-bank chain status` work as CLI commands
3. State persists across CLI restarts (theme, layout mode)
4. Convex dev server connects successfully
5. All 5 themes render correctly with semantic colors
6. Tab navigation (Ctrl+1, Ctrl+2, Ctrl+3) switches pages
7. AppShell displays Banner at top, Footer at bottom

### Dependencies

- Bun 1.0+ (existing)
- Ink 5.1.0 (existing)
- React 19.2.0 (existing)
- Foundry/cast (existing - for future stories)

### Tech-Spec Reference

[tech-spec.md](./tech-spec.md) - Complete technical specification including:
- ADR-001 revised: Ink-First with Essential CLI Commands
- ADR-002: Jotai Over Context
- ADR-005: Convex for Real-Time
- Full source tree changes
- Code examples and patterns

---

## Story Map - Epic 1

```
Epic: Foundation Infrastructure (13 points)
│
├── Story 1.1: Simplify CLI to Ink-First (2 points)
│   Dependencies: None
│   Outcome: Interactive default + essential CLI commands
│
├── Story 1.2: Add Jotai + Error Infrastructure (3 points)
│   Dependencies: Story 1.1
│   Outcome: Atomic state + named error classes
│
├── Story 1.3: Add Convex Infrastructure (2 points)
│   Dependencies: None (can parallel with 1.1/1.2)
│   Outcome: Real-time backend ready
│
├── Story 1.4: Implement Theme System (3 points)
│   Dependencies: Story 1.2 (needs Jotai atoms)
│   Outcome: 5 themes, theme switching, persistence
│
└── Story 1.5: Create AppShell + Page Routing (3 points)
    Dependencies: Stories 1.2, 1.4 (needs state + themes)
    Outcome: Complete layout with navigation
```

---

## Stories - Epic 1

### Story 1.1: Simplify CLI to Ink-First

Simplifies to interactive-first with essential CLI commands (like Claude Code pattern).

**Story Points:** 2
**Prerequisites:** None

### Story 1.2: Add Jotai State Management + Error Infrastructure

Implements atomic state management per ADR-002 and expands error handling with named error classes.

**Story Points:** 3
**Prerequisites:** Story 1.1 (clean entry point)

### Story 1.3: Add Convex Infrastructure

Sets up real-time backend per ADR-005.

**Story Points:** 2
**Prerequisites:** None (can run in parallel)

### Story 1.4: Implement Theme System

Creates 5-theme system per UX Design Spec.

**Story Points:** 3
**Prerequisites:** Story 1.2 (theme atom)

### Story 1.5: Create AppShell + Page Routing

Builds layout architecture with navigation.

**Story Points:** 3
**Prerequisites:** Stories 1.2, 1.4

---

## Implementation Timeline - Epic 1

**Total Story Points:** 13

**Implementation Sequence:**

| Order | Story | Points | Can Start After |
|-------|-------|--------|-----------------|
| 1 | Story 1.1: Ink-First CLI | 2 | - |
| 1 | Story 1.3: Add Convex | 2 | - (parallel) |
| 2 | Story 1.2: Add Jotai | 3 | Story 1.1 |
| 3 | Story 1.4: Theme System | 3 | Story 1.2 |
| 4 | Story 1.5: AppShell | 3 | Stories 1.2, 1.4 |

**Critical Path:** 1.1 → 1.2 → 1.4 → 1.5 (11 points)
**Parallel Work:** 1.3 can run alongside 1.1/1.2

---

_Generated by BMad Tech-Spec Workflow_
_Date: 2025-11-27_
